---
title: "Math230 Dashboard"
author: "Alex Searle, Justin Verlin, Jean Marie Ngabonziza"
output: flexdashboard::flex_dashboard
date: "2025-04-08"
runtime: shiny
---

```{r}
library(Lock5Data)
library(shiny)
library(ggplot2)
```

Column 
-------------------------------------
    
### Population Graph
    
```{r}
ui = fluidPage(
  fluidRow(
    column(12, selectInput("dataset_choice", "Select a dataset:",
                           choices = c("BodyTemp50", "Cereal", "BaseballSalaries2019", "StudentSurvey", 
                                       "Normal Distribution", "Exponential Distribution", "Binomial Distribution"),
                           selected = "BodyTemp50"))
  ),
  fluidRow(
    column(12, plotOutput("histPlot", height = "300px"))
  ),
    fluidRow(
    column(12,
           HTML("<p><strong>What is a Population Graph?</strong><br>
           A population graph, such as a histogram, shows how values in an entire dataset are distributed. It groups values into intervals (called bins) 
           and displays how frequently values occur within each bin. This helps us understand patterns in the data like the center, spread, and shape.</p>
           
           <p><strong>What is a Distribution?</strong><br>
           A distribution describes the overall pattern of how values are spread out in a dataset. It helps us see where values cluster, how much they vary, 
           and whether the shape is symmetric, skewed, or uniform.</p>")
    )
  ),

    fluidRow(
    column(12, verbatimTextOutput("meanText")) 
  )
)

server = function(input, output, session) {
  normdist = rnorm(100000, mean = 10, sd = 1)
  expdist = rexp(10000, rate = 1)
  binomdist = rbinom(10000, size = 10000, prob = 0.75)

  output$histPlot = renderPlot({
    var = na.omit(switch(input$dataset_choice,
                  "BodyTemp50" = BodyTemp50$BodyTemp,
                  "Cereal" = Cereal$Sugars,
                  "BaseballSalaries2019" = BaseballSalaries2019$Salary,
                  "StudentSurvey" = StudentSurvey$Height,
                  "Normal Distribution" = normdist,
                  "Exponential Distribution" = expdist,
                  "Binomial Distribution" = binomdist,
                  NULL))

    ggplot(data.frame(x = na.omit(var)), aes(x = x)) +
      geom_histogram(binwidth = (2 * IQR(na.omit(var)) / (length(na.omit(var))^(1/3))), fill = "navyblue", color = "white") +
      geom_vline(aes(xintercept = mean(x, na.rm = TRUE)), 
                 color = "red", linetype = "dashed", linewidth = 2) +
      labs(title = paste("Population Histogram of", input$dataset_choice),
           x = "Value", y = "Frequency") +
      theme_minimal()
  }, height = 300, width = 500)
  output$meanText <- renderPrint({
  var = na.omit(switch(input$dataset_choice,
                "BodyTemp50" = BodyTemp50$BodyTemp,
                "Cereal" = Cereal$Sugars,
                "BaseballSalaries2019" = BaseballSalaries2019$Salary,
                "StudentSurvey" = StudentSurvey$Height,
                "Normal Distribution" = normdist,
                "Exponential Distribution" = expdist,
                "Binomial Distribution" = binomdist,
                NULL))
  
  cat("Mean:", round(mean(var, na.rm = TRUE), 4))
})

}


shinyApp(ui, server)
```
   
Column {.tabset}
-------------------------------------
   
### Chart 2

```{r}

```   
 
### Chart 3
    
```{r}
```
